<html>
	</head>
<body>
<div class="counter">
    <div class="value"></div>
    <div class="label">Subscribers</div>
</div>
<script type="text/javascript" src="./api.js"></script>
<script type="text/javascript">
    let popcornHeaders = new Headers();
    popcornHeaders.append('cache-control', 'no-store');
    const counterValue = document.querySelector('.value');
    const popcorn = () => {
        console.clear();
        console.info('Fetching data...');
        fetch(`https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${UC_-RhG9pbrYTsGPVmCns_kQ}&key=${AIzaSyAwxeFvT3qsOM54WdG1VRvY2mMCHHvjplw}`,
            {
                credentials: 'same-origin',
                headers: popcornHeaders
            })
            .then(response => response.json())
            .then(function (response) {
                updateView(response.items[0].statistics.subscriberCount);
            });
    };
    const updateView = (subscribersCount) => {
        console.info('Updating view...');
        counterValue.innerHTML = subscribersCount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    };
    const app = () => {
        console.info('üçø');
        popcorn();
        window.setInterval(popcorn, 5000);
    };
    document.addEventListener('DOMContentLoaded', app());
</script>
</body>
</html>
